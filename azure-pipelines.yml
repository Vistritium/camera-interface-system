trigger:
- master

pool:
  vmImage: 'ubuntu-latest'
container: 
    image: nowicki.azurecr.io/scala-build:latest
    endpoint: nowicki


steps:
- task: Npm@1
  inputs:
    workingDir: 'frontend'
    command: 'install'
- task: Npm@1
  inputs:
    workingDir: 'frontend'
    command: 'custom'
    customCommand: 'run build'
- script: sbt docker:publishLocal
  displayName: 'Compile scala and build docker'
- task: Docker@2
  inputs:
    containerRegistry: 'nowicki'
    repository: 'nowicki/camera-interface-system'
    command: 'push'
    tags: 'latest'